# 数据库事务
事务时数据库区别于文件系统的重要特征之一。
事务：一组逻辑操作单元，使数据从一种状态变换到另一个状态。
事务处理的原则：保证所有事务都作为一个工作单元来执行，即使出现了故障，都不能改变这种执行方式。当在一个事务中执行多个操作时，要么所有的事务都被提交（commit）,那么这些修改就永久地保存下来；要么数据库管理系统将放弃所作的所有修改，整个事务回滚（rollback）到最初的状态。
事务的ACID特性
+ 原子性（atomicity）
	+ 事务中的所有操作是一个整体
+ 一致性（consistency）
	+ 一致性是指事务执行前后，数据从一个合法性状态变换到另一个合法状态，这种状态是语义上的而不是语法上的，跟具体的业务有关。
+ 隔离性（isolation）
	+ 事务的隔离性是指一个事务的执行不能被其他事务干扰，即一个事务内部的操作和使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能相互干扰
+ 持久性（durability）
	+ 事务一旦提交，它对数据库中数据的改变就是永久性的
	+ 持久性是通过事务日志来保证的。日志包括了重做（redo）日志和回滚日志。当我们通过事务对数据进行修改时，首先会将数据库的变化信息记录的重做日志中，然后再对数据库中的对应行进行修改。这样做的好处是，即使数据库系统崩溃，数据库重启后也能找到没有更新到数据库系统中的重做日志，重新执行，从而使事务具有持久性。
# 事务的状态
![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230212184509.png)
+ 活动的（active）
+ 部分提交的（partially committed）
+ 失败的（faild）
+ 中止的（aborted）
	+ 失败后回滚结束的状态
+ 提交的（committed）

# 数据并发问题
1. 脏写（Dirty Write）
	如果事务Session A修改了另一个未提交事务Session B修改过的数据，就意味着发生了脏写。
2. 脏读（Dirty Read）
	Session A读取了已经被Session B更新但还没有被提交的字段。
3. 不可重复读（Non-Repeatable Read）
	Session A读取了一个字段，然后Session B更新了该字段，之后Session A再次读取了同一个字段，值就不同了。
4. 幻读（Phantom）
	Session A从一个表中读取了一个字段，然后Session B在该表中插入了一个新的行，之后，如果Session A再次读取同一个表，就会多出几行，就意味着发生了幻读。
# 事务隔离级别
数据库事务隔离级别有四个，由低到高依次为Read uncommitted、Read committed、Repeatable read、Serializable，这四个级别分别解决脏写、脏读、不可重复读、幻读这几类问题 
+ Read uncommitted（读未提交）：这是最低的隔离级别，允许读取未提交的数据，它可能导致脏读，不可重复读和幻读。
+ Read committed（读已提交）：这是比Read uncommitted更高的隔离级别，禁止读取未提交的数据。它可以避免脏读，但仍然可能导致不可重复读和幻读
+ Repeatable read（可重复读）：这是比Read committed更高的隔离级别，禁止读取已提交的数据的修改。它可以避免脏读和不可重复读，但仍然可能导致幻读。
+ Serializable（串行化）：这是最高的隔离级别，禁止读取已提交的数据的修改和插入。它可以避免脏读、不可重复读和幻读。
