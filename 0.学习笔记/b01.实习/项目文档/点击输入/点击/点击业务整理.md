# 点击业务整理

涉及**两种指令**：点击元素（win/web）指令和 鼠标点击指令

## 点击元素指令

目前支持两种点击方法：模拟人工点击、非模拟人工点击（对于不同类型元素方法不同）

包括**两种点击方式**：单击和双击

**鼠标按钮的不同**：左键和右键

**点击元素部位的不同**：中心点、随机位置、自定义

![点击元素指令](C:\Users\11547\Downloads\点击元素指令.png)

| 点击方法       | 底层实现                               | 备注 |
| -------------- | -------------------------------------- | ---- |
| 模拟人工点击   | autoit发送点击指令，其中cef使用的是cdp |      |
| 非模拟人工点击 | 不同元素实现不同，见下表               |      |

### 模拟人工点击

#### Autoit点击

`MouseClick` 函数会在屏幕上指定的坐标处模拟鼠标点击。可以指定点击的类型（左击、右击等）、坐标、点击的次数以及点击的速度。

```c#
MouseClick ( "button" [, x, y [, clicks = 1 [, speed = 10]]] )
```

`ControlClick` 函数会在指定窗口的指定控件上模拟鼠标点击。可以指定窗口、控件、点击的类型、点击的坐标、点击的次数等。

```c#
ControlClick ( "title", "text", controlID [, button = "left" [, clicks = 1 [, x [, y]]]] )
```

`Send` 函数可以模拟按下鼠标的快捷键，但通常不推荐这种方法，因为它可能会受到用户的干扰，而且只能在活动窗口中使用。

### 非模拟人工点击的实现方式

| 元素类型               | 非模拟人工点击输入实现 |
| ---------------------- | ---------------------- |
| Web(Chrome, Edge, CEF) | CDP实现                |
| IE                     |                        |
| uia                    |                        |
| acc                    |                        |
| Java                   |                        |
| Haly                   |                        |
| Sap                    | 调用Sap接口            |
| CV                     | 实现同模拟人工输入     |

## 鼠标点击指令

目前支持**两种点击方法**：模拟人工点击、驱动点击

包括**四种点击方式**：单击、双击、按下、弹起

**鼠标按钮的不同**：左键和右键

![鼠标点击指令](https://raw.githubusercontent.com/mowang111/image-hosting/master/img/%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB%E6%8C%87%E4%BB%A4.png)

| 输入方法 | 兼容性 | 稳定性（使用1~5五个等级表示，5表示稳定性最强） | 速度 | 热键支持 | 底层实现方式       |
| -------- | ------ | ---------------------------------------------- | ---- | -------- | ------------------ |
| 普通输入 | 100%   | 4                                              | 慢   | 是       | 直接使用autoit发送 |
| 驱动输入 |        | 5                                              | 快   | 是       |                    |