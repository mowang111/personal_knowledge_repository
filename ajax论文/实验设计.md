1. ## **时间规划**

   - [ ] 前端（串口屏引擎）（两周）
     - [ ] 基本的画图模块（一周）
     - [ ] 串口数据的处理模块（一周）
       - [ ] 按钮功能处理等等
   - [ ] 中间件（四周）
     - [ ] js分析引擎（两周）
       - [ ] jast编译
       - [ ] ast分析引擎
     - [ ] html分析引擎（两周）
       - [ ] 提取表格信息
       - [ ] 提取js代码
       - [ ] 将js代码交给js分析引擎
   - [x] 服务端（已完成）
     - [x] 返回html和json就可以
   
   ## 技术路线
   
   ![实验架构](https://raw.githubusercontent.com/mowang111/image-hosting/6face69441d8f595066abac75a8572b04efb32ed/typora_images/实验架构.png)
   
   ![技术路线](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/技术路线.jpg)
   
   ### 技术路线描述
   
   基于AGS开发模型的串口屏浏览器，在Linux中实现B/S架构中的HTML解析器，JS解析器，当串口屏输入网页URL时，引擎中的串口数据转换模块识别串口数据对应的控件类型，识别到为浏览器按钮控件时，通过功能注册表，找到默认的按钮功能，进而执行http请求模块，请求服务器网页文件，当传回html网页文件后，使用Gumbo开源函数库提取HTML中的控件对象清单，将控件对象保存在当前状态机中的控件列表中，并利用串口屏本身的指令集实现串口屏对应的控件布局引擎，按照控件对象清单在串口屏上显示，提取html文件中的js部分，利用jast开源组件实现JS解析器，提取JS解析器中语法与词法树中函数名，解析函数功能，在功能注册表中将HTML控件对象清单映射为串口屏控件对象，将词法树中函数名映射为控件对象命令，当网页界面在串口屏中渲染完成后，点击页面中的某个按钮（比如改变表格内容的按钮）时，串口数据转换模块会识别此按钮并在功能注册表中找到改按钮对应的功能，比如再次请求表格中的内容，服务器返回json格式的文件，同样交由html引擎识别并交由json解析模块解析，将数据交由布局引擎改变串口屏中的显示，至此完成一个闭环。
   
   ### 画图模块（布局引擎）
   
   画图模块使用大彩自带的指令操作，将对应指令封装成可调用的模块
   
   ![image-20220211180513051](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/image-20220211180513051.png)
   
   ## js分析引擎
   
   js分析引擎可参考开源项目[jast](https://github.com/DhaliwalX/jast)
   
   ![image-20220211181009940](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/image-20220211181009940.png)
   
   jast可将js代码转换成AST，然后进一步通过AST，转换成对应的功能调用
   
   ## HTML分析引擎
   
   html分析引擎可以使用goole的开源库[Gumbo](https://github.com/google/gumbo-parser)
   
   ![image-20220211181348889](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/image-20220211181348889.png)
   
   Gumbo可以解析html文件，提取对应的子标签
