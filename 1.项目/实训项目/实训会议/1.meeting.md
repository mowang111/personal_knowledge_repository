## 背景

小背景：医院目前存在物流效率低的问题

目前，宁波市第一医院已有后勤管理系统，但是各个系统比较分散，而且采用传统的调度方式，采用电话调度或者平台调度。存在如下问题：

（1）  对于运送员来说记录难：信息需随时记录，操作繁琐;报告难：报告要及时，时间限制大。

（2）  对于调度人员来说分类难：预约任务需要单独记录；了解情况难：无法随时获取运送员位置。

（3）  对于医院科室来说联系难：电话呼入频繁，通讯压力大；实时进度难：无法实时获取运送员信息。

## 目标

本项目主要目标：

（1）建设一系列创新的智能调度算法，根据定时任务调度、最优路径调度、“顺路带货”调度等多种调度需求，解决院内建筑复杂，垂直维度调度困难等问题；

（2）建设一套院内智慧物流配送软件平台，通过实时定位和智能调度算法，实现运送人员“满去满回”和“顺路带货”，提供“闲时抢单”功能，提高运送效率。为调度人员提供实时查看功能，为管理人员提供运送监管和安全监管功能，为医院领导提供领导驾驶舱，及时了解物流配送运行情况。



## 核心算法

![image-20211217113406779](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/image-20211217113406779.png)

![image-20211217113619581](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/image-20211217113619581.png)

### 实现该算法需要的数据

+ 运送员
  + 信誉分
    + 需要订单评价系统
  + 等待分
  + 当前距离（这部分数据从哪来？）
  + 订单分数
    + 比如稀疏区到集中区，订单分数高

## 应用平台

应用平台包括“智慧后勤”云平台、中央运送调配中心、前端手机App系统和领导驾驶舱等几个部分组成

### 智慧后勤云平台

智慧后勤云平台提供通用的支撑服务，为平台上的应用系统提供服务与支撑。主要包括移动应用容器服务、用户体系、消息服务、工作流引擎和数据接口服务，以稳定可靠的云平台支撑前端快速变化的需求。

（1）移动应用容器服务

移动应用容器实现移动应用的注册、发布、更新、上架、下架，并能对所有业务数据进行隔离、加密和保护，安全可靠，能够为移动操作系统提供安全保护的核心应用系统。

移动应用容器使用统一认证系统的用户数据进行登陆、审批等操作。包含新增插件、发布插件、更新插件版本、下架/删除插件等功能。

新增插件功能：实现各插件开发单位申请开发应用的审批流程，审批通过后，在应用管理系统中添加一条插件信息记录。

发布/更新插件功能：实现各插件完成开发后上线运行的管理和上架配置功能。在插件管理中增加该插件信，进行上架操作后，移动端用户可以读取该插件应用，并可使用。

下架/删除插件功能：实现插件的下架和删除功能。在插件管理系统中选择相应的插件，进行下架/删除操作。

插件后台服务注册功能：经过注册的服务才可供应用插件调用。插件后台服务注册实现服务的注册功能。应用插件提供了HTML5和原生系统API的统一接口，能够为HTML5实现跨平台的运行时环境。可提高开发效率，可跨平台运行在各个操作系统之上。

移动应用插件采用标准的HTML5技术，使用标准的HTML、CSS和JavaScript技术进行开发。支持常用的前端开发框架。

（2）用户体系

+ 用户和权限管理

平台中存在不同角色和不同岗位的用户，需进行统一用户管理，本平台采用自主研发的新一代的技术框架平台，遵循多层应用架构的设计思路，支持业界主流的技术标准，提供灵活扩展的技术框架来适应随需应变的业务发展要求。集中管理云平台上不同应用系统的所有用户，对用户整个生命周期的管理、用户帐号的统一管理以及用户属性的统一管理。主要包括：

管理服务：是整个统一用户管理系统核心的组成部分，它将给管理员和用户提供统一视图，将所有应用系统的用户管理集中到这一点进行。

查询服务：统一用户管理系统与身份认证网关结合时，网关通过该服务来获取登录用户的账号以及各项属性信息。

同步服务：用于统一用户管理系统和各单位系统之间的数据交互，主要完成从平台中获得用户的初始信息，以及将统一用户管理的用户信息同步到其它的系统中。

数据库：用于存储内部和外部用户的所有用户信息，包括所管理的应用系统信息，以及用户在各应用系统下的所有从帐号、从帐号与主帐号的对应关系等。

适配器：是同步服务和各应用系统之间实现帐号、密码同步的桥梁和纽带，通常部署在应用服务端的网络安全域中。

+ 登录验证

智慧后勤云平台为移动端和PC端提供内置的用户体系，并支持WindowsAD域等其他方式的登录验证。

采用单点登录认证机制，即只需要在客户端登录一次，系统将会自动记录登陆的Session，在后续的每个网络请求中，都会带上此用户登录成功的Token，在保证访问安全的同时，也无需用户在移动应用内的每一个应用都重复输入用户名密码。

+ 设备绑定

平台为移动端应用提供设备绑定功能，可有效防止自己的移动应用帐号被盗用，或在手机丢失后快速锁定移动应用。

在一台新设备上首次登陆移动应用系统时，系统会自动发送一条短息到此用户的手机号，在用户名/密码/验证码输入正确的情况下，系统将实现用户账号、手机号、设备号三项绑定。

+ 云通讯录

云通讯录数据可从基础平台或其他数据源自动同步，支持按照部门查看，以及按照人员列表查看并快速搜索。通讯录支持显示头像、并具有来电显示功能。

（3）消息服务

+ 短信集成

支持提供短信集成服务，支持短信网关整合功能，实现在后台自动发送短信提醒、短信验证码、短信操作回复码等功能。

+ 数据推送

数据推送实现把后台应用系统中的数据实时推送到手机端，提高移动工作效率，降低消息获取时间成本。

离线消息机制：离线消息机制可以保证用户在频繁切换网络，甚至关闭网络的情况下，只要再次联网，就可以一条不落的收到之前发送的历史消息，确保信息的完整传递。

到达确认与失败重传机制：作为可靠的信息服务，具备消息送达的成功提示。这样消息的发送放就可以确保自己的消息已经推送到目标用户手机。如果推送消息的接受方不在线，或由于网络原因收到的数据不完整，将会启动失败重传机制，确保消息的100%送达。

跨平台推送：推送支持iOS和Android平台，并且向第三方应用提供了更简便、功能更强大的推送功能。

统一可调用的推送服务：推送为后台的各种应用提供了统一的调用接口，可实现会议通知推送、公告推送、图文信息推送等各种多媒体信息的推送，并且不限制推送内容大小，也不用收取短信一样的额外费用。

+ 消息中心

消息中心中有聚合显示了各类系统推送消息（会议通知、公告信息、系统消息）和即时消息的会话（单聊和群聊）。

（4）工作流引擎

工作流引擎根据角色、分工和条件的不同决定信息传递路由、内容等级等核心解决方案。工作流引擎包括流程的节点管理、流向管理、流程样例管理等功能。

（5）数据接口服务

数据接口服务承担了与其他第三方系统接口交换的任务，可根据需求部署在对外接入局域网或管理网。

+ 移动应用接口

移动应用接口采用最新的移动技术框架开发，能够通过混合开发模式让JavaScript调用设备原生的开发接口，如拍照、本地文件读写，安全网络访问等。

HTML5调用原生代码的接口符合USDK规范，支持GovRequest、GovUser、GovUtil等接口，并可在安卓和iOS平台上同时调用。

+ 定位系统对接

平台与定位系统对接，获取运送人员的实时定位数据，为运送调度提供位置信息。

+ BIM系统对接

平台与BIM系统对接，获取院内建筑的室内空间数据，结合应用平台，进行人员位置的展示，为运送调度提供室内空间数据。

+ HIS系统对接

平台与HIS系统对接，获取HIS系统中的相关业务数据，自动生成运行任务。作为平台的运送任务的来源之一。

### 中央运送调配中心

运送调配管理中心提供对运送人员、任务、调度的管理。主要功能包括：

+ 人员基本信息管理

对所有运送人员基本信息的管理，进行新增、修改、删除等，记录运送人员的信息。可以进行查询和统计。

+ 人员定位管理

通过对接医院室内空间数据，在系统中可结合平面和立面图查看运送员位置，系统可自动根据调配算法进行任务指派，或调度员根据人员位置、负载进行手工任务分配，实现统筹分工，提高人员工作效率。传统模式中管理人员想知道员工当前位置和工作负载，没法主动实时了解这些只能通过电话进行反馈得知，这在一定程度上没能实现人力资源的最大程度发挥。中央运送调配中心将人员定位实时位置和工作状态都显示在平面图上，可解决人员当前位置和状态不明的问题。

+ 任务过程监管

可看任务状态：已发布、已派单、已完成、未执行的、逾期。对于未及时查看及逾期的任务，系统会自动预警提示。在传统模式中由于对员工工作状态的不透明，所以调度员不能第一时间了解任务进行程度。中央运送系统可实时查看任务处于何种状态，针对超时任务系统会自动预警，方便调度员第一时间了解情况确保整个运送过程的及时性。

+ 自动任务发布

自动任务发布模式可根据运送人员或陪检人员在线工作情况，系统自动按照识别的状态逐个推送个有空的工作人员。

+ 调配算法设置

系统预设了多种任务调配算法，选择合适的算法进行设置，满足在不同时间段和不同情况下的任务调配需求。

+ 人员绩效考核

系统根据设定的绩效考核标准，对运送人员的绩效进行考核。通过任务执行数据的采集和计算分析，得出每个运送人员的工作任务完成情况，完成人员绩效考核。

+  多位数据统计分析

多维度数据统计分析课自动统计多维度数据，包括人员工作量、科室工作量、类型工作量等。改变传统纸质的工作量统计模式，中央运送调配中心会自动记录多维度数据，可提供多种数据组合和数据报表，更有利于对数据的分析。

### 手机app

（1）运送人员App

运送人员手机App系统主要包括以下功能模块：

+ 固定任务查看

运送人员查看每天的固定运送任务，根据固定任务的时间要求到指定地点执行运送任务。任务完成后，相应的固定任务状态变为“已完成”。对逾期未执行的固定任务，系统会在App进行提醒。

+ 指派任务接单

运送人员查看系统临时指派的运送任务，根据要求到指定地点执行。完成后，任务状态变为“已完成”。对逾期未执行的任务，系统会在App进行提醒。

+ 任务抢单

系统支持抢单模式，打破传统的区域分配方案，通过抢单功能实现运送人员全院范围内任务的执行，通过抢单再结合制定的绩效分配方案鼓励员工多劳多得，提供工作效率和员工工作积极性。

运送人员在工作闲时可在App进行任务抢单。临时的运送任务在App发布后，运送人员根据自身情况进行抢单。

+ 扫码执行任务

运送人员在执行任务前，支持手机扫码。App支持标本扫码、病人腕带扫码、检查单扫码、运送地点扫码，代替传统的人工登记，工作效率高。通过扫码，实现关键信息和数据的自动采集，相比纸质更高效更便捷。

+ 电子化交接

电子化签名代替传统的纸质登记。系统支持运送任务交接的电子化签名，通过签名图片形式保存，对比纸质签名记录更清晰更完整。通过手机扫码及电子化签名实现整个运送过程的无纸化办公。

+ 任务查询

运送人员查看自己已经执行的历史任务、逾期未执行的任务和即将要执行的任务。

（2）运送调配人员App

+ 任务查看

运送调配人员在App中查看所有任务，根据任务的类型、状态、运送物品种类等进行分类查看。可查看正在执行中的任务情况，该任务运送人员当前位置情况。

+ 人员查看

查看所有运送人员情况，根据人员的分类、当前状态等进行分类查看。可根据姓名、工号、工种等进行查询。可查看某一运送人员当前状态、当前位置情况，可为其指派任务。

+ 发起任务

在App系统中新增运送任务，进行任务发布，或进行指定派单。

+ 任务指派

根据运送任务要求，人工指派任务。可新增运送任务，选择运送人员，或根据系统调度算法推荐的运送人员中进行选择。任务指派后，相应运送人员能收到任务通知。

+ 任务统计

根据任务的时间、类型、状态等不同的统计维度进行任务统计，以列表和图标的方式展示。

### 领导驾驶舱

为医院领导提供驾驶舱功能，在领导驾驶舱模块，通过多维数据统计，集中展示系统中任务、人员、物资的实时状态，展示各类统计数据。还可根据需要进入不同的维度，展示其更详细的信息，并可进行相关操作，满足领导对整体情况的了解和对具体细节的操作。