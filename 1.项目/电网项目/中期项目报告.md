# 第二章：含高比例新能源的交直流混联电网的复杂故障集构建

### 2.2 含高比例新能源的交直流混联电网的智能扰动生成方法

深度强化学习需要大量的数据来挖掘数据之中潜在的关系，再而样本数据质量对于数据分析结果有重要的影响，所以首先要生成大量样本数据用来训练。样本通过bpa仿真软件来进行时域仿真生成，为了全面考虑系统运行的不同工况，从系统负荷水平、故障线路、故障位置和故障持续时间等 4 方面进行暂态稳定仿真，批量构造数据集。其中设置最严重的三相短路故障，故障线路分别为 34 条交流输电线路；故障位置为交流线路的 0%至 100%，以 10%的步长增加的 11 种故障点；故障清除时间为故障发生后的 5周波至 24 周波（一周波0.02s），以 1 周波的步长增加的 20 种变化情况；系统负荷水平在 90%至 110%的范围内随机波动；仿真时间共 100周波，以仿真过程中任意两个发电机功角差大于270度为失稳样本。由于负荷是随机波动，故而可以生成多轮样本，每一轮生成样本20*34*11=7480个，共生成7轮，仿真共生成失稳样本 7432 个，按 5:2 的比例划分训练集和测试集。如图4.7所示，这是一个对第18条线路进行扰动的可视化样本，可以通过曲线观察失稳发电机的状况。
![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230325193109.png)

### 2.3 基于生成对抗网络的失稳样本生成方法

2.3.1 引言

传统的电力网时序数据分析在实践中会面临高噪声水平和缺乏多样性等问题。针对这些问题，人工智能中的生成对抗网络（GAN）方法可以提供有效的解决方案。GAN是一种无监督学习方法，通过同时训练生成器网络和判别器网络来生成高质量和多样性的数据样本。在电力网时序数据分析中，使用GAN方法可以降低噪声水平和提高数据多样性。降低噪声水平可以提高数据质量，增加后续分析和建模的准确性；而提高数据多样性可以更好地利用电力网数据的潜在非线性特征和多样性。因此，GAN在电力网时序数据分析中具有重要意义，可以提高数据分析的精度和效率。

然而，电力系统中时序实值数据生成领域不够成熟，存在数据特征维度高、RNN模型导致的模型训练不稳定等问题，对此提出一种时序生成模型CDouble-GAN，模型包括编解码器、两对生成器-鉴别器Transient GAN和Time-series GAN，其中编解码器对数据进行预处理，解决电网特征维度高的问题；通过使用AR-FNN代替RNN解决Lipschitz连续性问题，从而可以使用Wasserstein distance对目标函数进行稳定优化。此外，将数据类别标签引入模型，以此生成特定类别的样本数据。

2.3.2 Wasserstein 距离

Wasserstein距离，又称推土机距离，是用来度量两个概率分布之间的距离的一种方式。它的计算方法是将两个分布中的所有可能的联合分布的集合组合起来，并从中采样得到一个真实样本和一个生成样本，再算出这对样本的距离。可以计算在所有可能的联合分布中能够对样本对距离的期望值取到的下界，就定义为Wasserstein距离。它是一种连续性度量，因为如果两个分布越接近，那么它们的Wasserstein距离就越小。

由于Wasserstein距离中的最小化问题难以直接求解，原作者将其变换为一个可以通过神经网络求解的形式。具体而言，他们提出了一个带有Lipschitz连续性的判别器网络，它将真实样本和生成样本的距离作为输入，并输出它们的Wasserstein距离。为了满足Lipschitz连续性，他们引入了谱归一化的处理方法。谱归一化是一种用于限制神经网络权重大小的方法，可以控制函数变化的剧烈程度，从而使得模型训练更加稳定。通过引入谱归一化，他们确保了判别器网络满足Lipschitz连续性，并使其可以用来近似拟合Wasserstein距离。

2.3.3 模型架构

该模型由编解码器、时刻样本生成器、时刻判别器、时序样本生成器和时序判别器组成。编解码器结构作用于整个模型的前后两端，既可以降低数据特征的维度，最大程度保留特征信息，又可以将数据归一化到0~1之间。相比于直接使用高斯混合模型对特征数据进行处理，编解码器的处理具有更强的适应性。时刻样本生成器的输入为随机噪声和样本所属的类别标签，输出为符合类别标签信息的单一时刻样本，用于时序样本生成前的预生成。时序样本生成器的输入为随机噪声、样本所属的类别标签以及时刻样本生成器生成的单一时刻样本，输出为符合标签信息的时序样本。两个判别器的输入分别为真实的时刻/时序样本和生成器生成的时刻/时序样本，输出是对真实样本和生成样本的分布距离的评价指标。

![image-20230402203618141](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/image-20230402203618141.png)

2.3.4 实验

在新英格兰39节点系统基础上，修改所有负荷和发电机功率，使得其在0.9-1.2倍的范围内随机浮动，同时在46条线上遍历选取一条，在其每隔10%的位置上随机选取一点设置三相短路故障，故障时间在5-15周波，由此得到一批时序数据，然后每个数据可根据线路角度差是否大于150度来判断每条线路的失稳情况，从线路的失稳情况判断整个系统的暂态失稳状况，同时将数据集按照失稳的线路（包括稳定）进行分类，最终选取部分稳定数据和29，31，32，33四种线路失稳的数据，为了简化实验，仅选取故障清除后十个周波的线路特征的时间序列作为样本，共20326个样本。

| 特征       | 符号表示                                                     |
| ---------- | ------------------------------------------------------------ |
| 有功功率   | ![img](file:///C:/Users/11547/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png) |
| 无功功率   | ![img](file:///C:/Users/11547/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png) |
| 线路角度差 | ![img](C:/Users/11547/AppData/Local/Temp/msohtmlclip1/01/clip_image006.png) |

# 第四章：基于人工智能算法的稳定判别技术可信度提升



## 4.7 基于人工智能方法的阻抗估计方法

电力系统的稳定运行对于现代社会的正常运转至关重要。为了实现电力系统的稳定运行，需要对电网的动态特征有深入的了解。传统的电力系统建模方法通常是基于物理方程，但由于电力系统的复杂性和不确定性，这种方法存在着精度不高、难以扩展和计算量大等问题。

在电力系统中，阻抗是一个重要的概念，它表示电路对电流的阻力。阻抗值的计算通常需要通过对电力系统的动态特征数据进行处理和分析，然而这个过程中可能会存在误差和计算复杂度高的问题。因此，本实验旨在使用机器学习算法建立电网动态特征数据与阻抗值之间的映射关系，从而实现对阻抗值的预测。本实验通过对不同数量的输入节点进行实验，包括1个节点（7号节点）、4个节点（5、6、7、8号节点）、8个节点（4、5、6、7、8、9、11、31号节点）以及13个节点（4、5、6、7、8、9、10、11、12、13、14、31、32号节点），来探究输入节点数量对阻抗预测精度的影响。

![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230325192301.png)

### 数据生成
在实验中，我们生成了不同的阻抗样本来训练和测试我们的机器学习模型。具体地，我们对选定的电力线路的rxb进行0.5-3倍的随机变化来生成不同的阻抗。同时，我们对整体负荷进行0.8-1.2的随机扰动，以增加数据的丰富性。

我们通过负荷持续增长（LI）来制造大的扰动，然后通过计算得到阻抗值。同时，我们也通过负荷持续周期波动（LF）来制造小扰动，并分别计算当前扰动情况下，根据机理计算（取一个周波的差值）和人工智能计算的结果。

这样生成的数据样本包括不同的阻抗值和不同的扰动情况，能够更全面地反映电力系统的动态特征，有助于我们更准确地建立模型并进行预测。

### 阻抗模型

本实验使用的阻抗模型是五层全连接神经网络。该模型的输入是动态特征数据，包括电压、相角、有功功率、无功功率等多个指标，具体输入指标数量根据不同实验分别为1、4、8、13个节点。该模型的输出是对应的阻抗值。为了防止过拟合，我们在全连接层中使用了Dropout技术。

为了保证模型的预测准确性，我们使用了分位数损失函数。分位数损失是一种不同于均方误差（MSE）或平均绝对误差（MAE）的损失函数。它的基本思想是，将损失函数设计成分位数的形式，这样可以对模型在不同分位数处的误差赋予不同的权重。在这个实验中，我们使用的是分位数为0.99的损失函数。分位数损失的优点在于，它可以使得模型更加关注误差较大的样本，而对误差较小的样本影响较小。这对于电力系统中的阻抗预测非常有用，因为一些阻抗值可能会出现较大的偏差，这时候我们希望模型更加关注这些误差较大的样本，以提高模型的准确性。

![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230325194831.png)

模型使用的是五层全连接神经网络，每一层都包含有256个神经元。其中，第一层为输入层，输入的特征包括电网动态特征数据，例如电压、电流、功率因数等。第二层和第三层为隐藏层，用于提取特征和降维。第四层也为隐藏层，但与前面两层的结构略有不同，包含了四个子层，每个子层都包含有32个神经元，每个子层的输入为前一层的输出，这样可以增加网络的非线性程度，提高网络的表达能力。最后一层为输出层，输出的是阻抗值。

为了避免过拟合，网络的每一层之间都使用了批量归一化技术，同时在每一层的输出都添加了ReLU激活函数。在输出层，由于需要对阻抗值进行非线性的预测，因此没有使用激活函数。

![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230325192307.png)

训练过程中，我们采用Adam优化器和学习率衰减策略，Adam是一种自适应学习率优化算法，它可以根据训练过程中的梯度信息自适应地调整学习率，从而提高模型的训练速度和准确性。

Adam算法的基本思想是，将梯度的一阶矩估计和二阶矩估计结合起来，以自适应的方式调整学习率。具体来说，Adam算法计算每个参数的梯度的指数移动平均值和指数移动平均值的平方根，然后根据这些信息调整学习率。

Adam算法的优点在于，它可以自适应地调整学习率，避免了手动调整学习率的繁琐过程，从而提高了模型的训练速度和准确性。同时，Adam算法还可以在处理稀疏数据时保持稳定性，这对于电力系统中的阻抗预测非常有用，因为电力系统中的数据往往是稀疏的。

学习率衰减是一种在模型训练过程中动态调整学习率的技术，其目的是在训练初期使用较大的学习率，快速接近最优解，而在训练后期逐渐降低学习率，有助于模型收敛到更好的局部最优解。

### 实验结果
下面是阻抗模型的实验结果，展示了不同扰动幅度时，人工智能模型中分别取1，4，8，12个节点以及机理计算情况下，误差的分布情况，其中横坐标展示为扰动幅度，纵坐标为误差，图中的每一个长条状图形表示了当前扰动幅度下，人工智能方法或者是机理及计算方法的误差分布范围。
![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230325192416.png)
这里的图片横坐标是扰动的幅度，纵坐标是误差值，有四个图例分别代表人工智能计算下使用4个节点，8个节点，12个节点以及机理计算的结果，图中的每一个长方块表示了在当前扰动幅度下，人工智能方法或者是机理计算方法的误差分布范围，这样可以直观将人工智能方法和机理计算方法做对比，比如扰动幅度为4时，第一个黄色长条就是机理计算的误差分布，接下来四个不同颜色的长条就是不同节点数下人工智能计算的误差分布。
![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230325192532.png)

上图的横坐标是扰动幅度，纵坐标是平均误差，表示了节点数1，4，8，13和机理计算情况下，在不同扰动幅度下的平均误差

可以看到：(1) 在扰动情况较小时，阻抗模型的计算误差明显小于机理计算，随着扰动幅度的增大，机理计算的误差更小。当节点数为1，扰动幅度为10左右时，机理计算和人工智能方法出现交汇点。（2）节点数从1到8时对误差影响较大，从8到12时则影响不大。

![image.png](https://raw.githubusercontent.com/mowang111/image-hosting/master/typora_images/20230325192613.png)



上图的横坐标是节点数，纵坐标是误差，表示了节点数1，4，8，13的情况下的误差分布情况，可以看到，当节点数取的越多时误差总体越接近0.