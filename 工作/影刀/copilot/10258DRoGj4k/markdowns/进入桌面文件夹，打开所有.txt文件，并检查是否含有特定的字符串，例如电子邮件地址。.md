---
tags:
---
{'err_funcs': ['xbot_visual.desktop.exist_text']}
```python
# 打开桌面文件夹
xbot_visual.keyboard.send_keys(keys="#d")
# 输入文件夹名称
xbot_visual.desktop.input(window="0", element="文件夹名称", text="桌面")
# 按下回车键，进入文件夹
xbot_visual.keyboard.send_keys(keys="{enter}")
# 遍历文件夹内的所有.txt文件
for file in xbot_visual.desktop.iter_all_elements(window="0", element="*.txt"):
    # 双击打开文件
    xbot_visual.desktop.click(window="0", element=file, clicks="dbclick")
    # 在文件中查找特定字符串，例如电子邮件地址
    if xbot_visual.desktop.exist_text(window="0", text="example@example.com"):
        # 打印文件名
        print(xbot_visual.desktop.get_attribute(window="0", element=file, attribute_name="text"))
    # 关闭文件
    xbot_visual.desktop.click(window="0", element="关闭")
```
---
```python
# 通过win+e快捷键打开文件资源管理器
xbot_visual.keyboard.send_keys(keys="#e")
# 进入桌面文件夹
xbot_visual.desktop.input(window="0", element="文件夹输入框", text="C:\\Users\\Administrator\\Desktop")
# 输入enter
xbot_visual.keyboard.send_keys(keys="{ENTER}")
# 遍历文件元素列表
for file in xbot_visual.desktop.iter_all_elements(window="0", element="文件元素"):
    # 获取文件名称
    file_name = xbot_visual.desktop.get_attribute(window="0", element=file, attribute_name="text")
    # 判断文件是否为.txt文件
    if ".txt" in file_name:
        # 双击打开文件
        xbot_visual.desktop.click(window="0", element=file, clicks="dbclick")
        # 获取文件文本
        email_text = xbot_visual.desktop.get_attribute(window="0", element="文本展示区", attribute_name="text")
        # 文本是否包含指定文本
        if "example text" in email_text:
            # 打印文件名,
            print(f"文件{file}中包含电子邮件地址"),
        # 关闭文件
        xbot_visual.desktop.click(window="0", element="关闭")
```
