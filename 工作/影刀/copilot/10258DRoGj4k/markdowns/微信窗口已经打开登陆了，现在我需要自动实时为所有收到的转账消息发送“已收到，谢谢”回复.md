---
tags:
---
{'err_funcs': ['xbot_visual.desktop.set_focus']}
```python
# 获取微信窗口
wechat_window = xbot_visual.desktop.get(title="微信")
# 循环
for message in xbot_visual.desktop.iter_all_elements(window="0", element="微信消息元素"):
    # 获取消息内容
    message_text = xbot_visual.desktop.get_attribute(window="0", element=message, attribute_name="text")
    # 判断是否为转账消息
    if "转账" in message_text:
        # 点击消息进入聊天窗口
        xbot_visual.desktop.click(window="0", element=message)
        # 在聊天输入框中输入回复内容
        xbot_visual.desktop.input(window="0", element="微信聊天输入框", text="已收到，谢谢")
        # 点击发送按钮
        xbot_visual.desktop.click(window="0", element="微信发送按钮")
        # 回到微信主窗口
        xbot_visual.desktop.set_focus(window=wechat_window)
```
---
```python
# 导入time模块
import time
# 根据微信窗口名称获取微信窗口对象
wechat_window = xbot_visual.desktop.get(title="微信")
# 循环，持续监听微信窗口中是否有新的转账消息
while True:
    # 遍历转账消息对象列表
    for transfer_message in xbot_visual.desktop.iter_all_elements(window="0", element="微信消息"):
        # 获取转账消息对象的文本内容
        transfer_message_text = xbot_visual.desktop.get_attribute(window="0", element=transfer_message, attribute_name="text")
        # 判断转账消息文本中是否包含关键字"转账已收到"
        if "转账已收到" in transfer_message_text:
            # 点击消息进入聊天窗口
            xbot_visual.desktop.click(window="0", element=transfer_message)
            # 在聊天窗口中，输入回复内容"已收到，谢谢"
            xbot_visual.desktop.input(window="0", element="聊天窗口回复输入框", text="已收到，谢谢")
            # 在聊天窗口中，点击发送按钮，发送回复消息
            xbot_visual.desktop.click(window="0", element="聊天窗口发送按钮")
            # 回复完返回
            xbot_visual.desktop.click(window="0", element="返回按钮")
    # 等待1秒
    time.sleep(1)
```
